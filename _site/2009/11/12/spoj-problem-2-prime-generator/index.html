<!DOCTYPE html>
<html>
  <head>
    <title>SPOJ Problem 2: Prime Generator (PRIME1) - Zero Wind :: Jamie Wong</title>
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

    <link href='http://fonts.googleapis.com/css?family=Questrial|Sansita+One' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" media="screen" href="/stylesheets/screen.css" type="text/css" />
    <link rel="stylesheet" media="screen" href="/stylesheets/pygments.css" type="text/css" />
  </head>

  <body class="bp" onload="prettyPrint()">
    <div class="page-container">
      <div class="page-sidebar-container">
        <div class="page-sidebar">

          <a href="/"><h1 class="site-title">
            Zer√∏ Wind
          </h1></a>

          <h2 class='my-name'>Jamie Wong</h2>

          <div class='short-bio'>
            <p>
              I'm a uWaterloo Software Engineering student from Ottawa.
              I'm currently an intern at Facebook.
            </p>
          </div>

          <div class="page-nav">
            <ul>
              <li><a href="/">blog</a></li>
              <li><a href="/resume/">resume</a></li>
              <li><a href="https://github.com/phleet">github</a></li>
              <li><a href="http://twitter.com/jlfwong">twitter</a></li>
              <li><a href="http://www.linkedin.com/profile/view?id=71283243">linkedin</a></li>
              <li><a href="http://stackoverflow.com/users/303911/jamie-wong">stack overflow</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div class="page-content-container">
        <div class="page-content">
          
            <h1 class='page-title'>SPOJ Problem 2: Prime Generator (PRIME1)</h1>
          

          
<div class="post-date">
  Posted on November 12, 2009
</div>


<div class="post">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<p>Problem: <a href="https://www.spoj.pl/problems/PRIME1/">Prime Generator</a></p>

<blockquote>
Peter wants to generate some prime numbers for his cryptosystem. Help him! Your task is to generate all prime numbers between two given numbers!
</blockquote>


<p><strong>Concept</strong>
The idea behind every solution here (with some variation) is to generate all the prime numbers that could be factors of numbers up to the maximum endpoint 1 billion. That square root happens to be around 32000. Using this array, do a bounded Sieve of Eratosthenes only in the range requested. In languages like php and python, it turns out that it's more efficient to build an associative array and check if the index is set than it is to generate a huge boolean array.</p>

<p><strong>Code</strong></p>

<p><strong>C++</strong></p>

<div class="highlight">
<pre><span class="cp">/// PRIME1 - C++ (g++)</span>
<span class="cp">// AC Time: 2.52s</span>
<span class="cp">// NOTE: I am aware that the use of vector and set actually</span>
<span class="cp">//  makes this code run _slower_</span>
<span class="cp">// I used vector and set simply as a way of practicing STL</span>
<span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;cmath&gt;</span>
<span class="cp">#include &lt;vector&gt;</span>
<span class="cp">#include &lt;set&gt;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">primes</span><span class="p">;</span>
    <span class="n">primes</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">32000</span><span class="p">;</span> <span class="n">i</span><span class="o">+=</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">bool</span> <span class="n">isprime</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

        <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">p</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">p</span> <span class="o">=</span> <span class="n">primes</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">p</span> <span class="o">!=</span> <span class="n">primes</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="n">p</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">p</span> <span class="o">&gt;=</span> <span class="n">cap</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="o">*</span><span class="n">p</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">isprime</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">isprime</span><span class="p">)</span> <span class="n">primes</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">T</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">;</span>

    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span><span class="p">;</span> <span class="n">t</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">M</span> <span class="o">&gt;&gt;</span> <span class="n">N</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

        <span class="kt">int</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

        <span class="n">set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">notprime</span><span class="p">;</span>
        <span class="n">notprime</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>

        <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">p</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">p</span> <span class="o">=</span> <span class="n">primes</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">p</span> <span class="o">!=</span> <span class="n">primes</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="n">p</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">p</span> <span class="o">&gt;=</span> <span class="n">cap</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">start</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">p</span> <span class="o">&gt;=</span> <span class="n">M</span><span class="p">)</span> <span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
            <span class="k">else</span> <span class="n">start</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="p">((</span><span class="o">*</span><span class="n">p</span> <span class="o">-</span> <span class="n">M</span> <span class="o">%</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="o">*</span><span class="n">p</span><span class="p">);</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">start</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="n">j</span> <span class="o">+=</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">notprime</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">M</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">notprime</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>
</div>


<p><strong>C99</strong></p>

<div class="highlight">
<pre><span class="cp">// PRIME1 - C99 (gcc)</span>
<span class="cp">// AC Time: 0.07s</span>
<span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;string.h&gt;</span>
<span class="cp">#include &lt;stdbool.h&gt;</span>
<span class="cp">#include &lt;math.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">primes</span><span class="p">[</span><span class="mi">4000</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">numprimes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="n">primes</span><span class="p">[</span><span class="n">numprimes</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">32000</span><span class="p">;</span> <span class="n">i</span><span class="o">+=</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">bool</span> <span class="n">isprime</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">numprimes</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">cap</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">isprime</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">isprime</span><span class="p">)</span> <span class="n">primes</span><span class="p">[</span><span class="n">numprimes</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">T</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">;</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">T</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span><span class="p">;</span> <span class="n">t</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%d %d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">M</span><span class="p">,</span><span class="o">&amp;</span><span class="n">N</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

        <span class="kt">int</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

        <span class="n">bool</span> <span class="n">isprime</span><span class="p">[</span><span class="mi">100001</span><span class="p">];</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">isprime</span><span class="p">,</span><span class="nb">true</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">isprime</span><span class="p">));</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">numprimes</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">primes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

            <span class="k">if</span><span class="p">(</span><span class="n">p</span> <span class="o">&gt;=</span> <span class="n">cap</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>

            <span class="kt">int</span> <span class="n">start</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">&gt;=</span> <span class="n">M</span><span class="p">)</span> <span class="n">start</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
            <span class="k">else</span> <span class="n">start</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="p">((</span><span class="n">p</span> <span class="o">-</span> <span class="n">M</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">);</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">start</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="n">j</span> <span class="o">+=</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">isprime</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kt">int</span> <span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="n">M</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span><span class="o">?</span><span class="n">M</span><span class="o">:</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"2</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">start</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">+=</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">isprime</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">M</span><span class="p">])</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>
</div>


<p><strong>PHP</strong></p>

<div class="highlight">
<pre><span class="cp">&lt;?</span>
<span class="c1">// PRIME1 - PHP</span>
<span class="c1">// AC Time: 5.73</span>

<span class="nv">$primes</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="nv">$numprimes</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;=</span> <span class="mi">32000</span><span class="p">;</span> <span class="nv">$i</span><span class="o">+=</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$isprime</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="nv">$cap</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nv">$i</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="nv">$j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">&lt;</span> <span class="nv">$numprimes</span><span class="p">;</span> <span class="o">++</span><span class="nv">$j</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$j</span> <span class="o">&gt;=</span> <span class="nv">$cap</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nv">$i</span> <span class="o">%</span> <span class="nv">$primes</span><span class="p">[</span><span class="nv">$j</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$isprime</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$isprime</span><span class="p">)</span> <span class="nv">$primes</span><span class="p">[</span><span class="nv">$numprimes</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$i</span><span class="p">;</span>
<span class="p">}</span>

<span class="nb">fscanf</span><span class="p">(</span><span class="nx">STDIN</span><span class="p">,</span><span class="s2">"%d"</span><span class="p">,</span><span class="nv">$T</span><span class="p">);</span>

<span class="nv">$output</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>

<span class="k">for</span> <span class="p">(</span><span class="nv">$t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$t</span> <span class="o">&lt;</span> <span class="nv">$T</span><span class="p">;</span> <span class="nv">$t</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$t</span><span class="p">)</span> <span class="nv">$output</span> <span class="o">.=</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>

    <span class="nb">fscanf</span><span class="p">(</span><span class="nx">STDIN</span><span class="p">,</span><span class="s2">"%d %d"</span><span class="p">,</span><span class="nv">$M</span><span class="p">,</span><span class="nv">$N</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$M</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">$M</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

    <span class="nv">$isprime</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>

    <span class="nv">$cap</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nv">$N</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>

    <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$numprimes</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$p</span> <span class="o">=</span> <span class="nv">$primes</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$p</span> <span class="o">&gt;=</span> <span class="nv">$cap</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$p</span> <span class="o">&gt;=</span> <span class="nv">$M</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$start</span> <span class="o">=</span> <span class="nv">$p</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nv">$start</span> <span class="o">=</span> <span class="nv">$M</span> <span class="o">+</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">-</span> <span class="nv">$M</span> <span class="o">%</span> <span class="nv">$p</span><span class="p">)</span> <span class="o">%</span> <span class="nv">$p</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="nv">$j</span> <span class="o">=</span> <span class="nv">$start</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">&lt;=</span> <span class="nv">$N</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">+=</span> <span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$isprime</span><span class="p">[</span><span class="nv">$j</span> <span class="o">-</span> <span class="nv">$M</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="o">++</span><span class="nv">$i</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="nv">$M</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;=</span> <span class="nv">$N</span><span class="p">;</span> <span class="o">++</span><span class="nv">$i</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$isprime</span><span class="p">[</span><span class="nv">$i</span><span class="o">-</span><span class="nv">$M</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$output</span> <span class="o">.=</span> <span class="s2">"</span><span class="si">$i</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">echo</span> <span class="nv">$output</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre>
</div>


<p><strong>Python</strong></p>

<div class="highlight">
<pre><span class="c"># PRIME1 - Python</span>
<span class="c"># AC Time: 3.10s</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="n">primes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">32000</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">isprime</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="n">cap</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;=</span> <span class="n">cap</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">isprime</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">isprime</span><span class="p">):</span>
        <span class="n">primes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">T</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
<span class="n">output</span> <span class="o">=</span> <span class="s">""</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span>

    <span class="n">M</span><span class="p">,</span><span class="n">N</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">cap</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">M</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="n">isprime</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">]</span><span class="o">*</span><span class="mi">100001</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">cap</span><span class="p">):</span>
            <span class="k">break</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">M</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">M</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">i</span><span class="p">)</span>

        <span class="c"># The two below, obscure lines create a continuous</span>
        <span class="c">#  block of false elements in order to set all</span>
        <span class="c">#  elements correspnding to numbers divisible by i</span>
        <span class="c">#  in isprime to be false</span>
        <span class="c"># In turns out that this runs substantially faster</span>
        <span class="c">#  than setting the elements individually using loops</span>
        <span class="n">falseblock</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">isprime</span><span class="p">[</span><span class="n">start</span><span class="o">-</span><span class="n">M</span><span class="p">:</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">M</span><span class="p">:</span><span class="n">i</span><span class="p">]);</span>
        <span class="n">isprime</span><span class="p">[</span><span class="n">start</span><span class="o">-</span><span class="n">M</span><span class="p">:</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">M</span><span class="p">:</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">falseblock</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">isprime</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">M</span><span class="p">]</span> <span class="o">==</span> <span class="bp">True</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span>

<span class="k">print</span> <span class="n">output</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre>
</div>


<p><strong>Bash</strong></p>

<div class="highlight">
<pre><span class="c"># PRIME1 Incomplete - BASH</span>
<span class="c"># This is not a complete solution</span>
<span class="c"># The speed of bash parsing makes getting an</span>
<span class="c">#  AC submission infeasible</span>

<span class="c"># The following code is a working prime generator</span>
<span class="c"># Giving enough time, it will output all prime</span>
<span class="c">#  numbers from 0 to 32000</span>
<span class="c"># ..which is the first step in the solution to PRIME1</span>

<span class="nb">let </span>PRIMES<span class="o">[</span>0<span class="o">]=</span>2
<span class="nb">let </span><span class="nv">NUMPRIMES</span><span class="o">=</span>1
<span class="k">for </span>i in <span class="o">{</span>3..32000<span class="o">}</span>; <span class="k">do</span>
<span class="k">    </span><span class="nb">let </span><span class="nv">ISPRIME</span><span class="o">=</span>1

    <span class="c">#for j in {0..$NUMPRIMES}; do</span>
    <span class="k">for</span> <span class="o">((</span> <span class="nv">j</span> <span class="o">=</span> 0;j&lt;<span class="nv">$NUMPRIMES</span>;j++ <span class="o">))</span>; <span class="k">do</span>
<span class="k">        </span><span class="nb">let </span><span class="nv">CURPRIME</span><span class="o">=</span><span class="k">${</span><span class="nv">PRIMES</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span><span class="k">}</span>
        <span class="k">if</span> <span class="o">[[</span> <span class="nv">$CURPRIME</span>*<span class="nv">$CURPRIME</span> -gt <span class="nv">$i</span> <span class="o">]]</span>; <span class="k">then</span>
<span class="k">            </span><span class="nb">break</span>
<span class="nb">        </span><span class="k">fi</span>

<span class="k">        </span><span class="nb">let </span><span class="nv">MOD</span><span class="o">=</span><span class="nv">$[$i</span> % <span class="nv">$CURPRIME</span><span class="o">]</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$MOD</span> -eq 0 <span class="o">]</span>; <span class="k">then</span>
<span class="k">            </span><span class="nb">let </span><span class="nv">ISPRIME</span><span class="o">=</span>0
            <span class="nb">break</span>
<span class="nb">        </span><span class="k">fi</span>
<span class="k">    done</span>

<span class="k">    if</span> <span class="o">[</span> <span class="nv">$ISPRIME</span> -eq 1 <span class="o">]</span>; <span class="k">then</span>
<span class="k">        </span><span class="nb">echo</span> <span class="nv">$i</span>
        <span class="nb">let </span>PRIMES<span class="o">[</span>NUMPRIMES<span class="o">]=</span><span class="nv">$i</span>
        <span class="nb">let </span><span class="nv">NUMPRIMES</span><span class="o">=</span>NUMPRIMES+1
    <span class="k">fi</span>
<span class="k">done</span>
&lt;/pre&gt;
</pre>
</div>


<p><strong>Ruby</strong></p>

<div class="highlight">
<pre><span class="c1"># PRIME1 - Ruby</span>
<span class="c1"># AC Time: 4.65s</span>
<span class="c1">#</span>
<span class="c1"># While I would have liked to use more</span>
<span class="c1"># Ruby idioms such as for p in primes</span>
<span class="c1"># or primes.each do |p| (used once),</span>
<span class="c1"># the difference in runtime between</span>
<span class="c1"># the use of loops like these and while</span>
<span class="c1"># loops was non-negligible</span>

<span class="n">primes</span> <span class="o">=</span> <span class="o">[</span><span class="mi">2</span><span class="o">]</span>

<span class="mi">3</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mi">32000</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
    <span class="n">isprime</span> <span class="o">=</span> <span class="kp">true</span>
    <span class="n">cap</span> <span class="o">=</span> <span class="no">Math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">primes</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">p</span> <span class="o">&gt;=</span> <span class="n">cap</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">end</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="nb">p</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">isprime</span> <span class="o">=</span> <span class="kp">false</span>
            <span class="k">break</span>
        <span class="k">end</span>
    <span class="k">end</span>

    <span class="k">if</span> <span class="n">isprime</span>
        <span class="n">primes</span> <span class="o">&lt;&lt;</span> <span class="n">i</span>
    <span class="k">end</span>
<span class="k">end</span>
<span class="n">numprimes</span> <span class="o">=</span> <span class="n">primes</span><span class="o">.</span><span class="n">length</span>

<span class="n">T</span> <span class="o">=</span> <span class="nb">gets</span><span class="o">.</span><span class="n">to_i</span>


<span class="n">output</span> <span class="o">=</span> <span class="s2">""</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span>
    <span class="nb">print</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="n">line</span> <span class="o">=</span> <span class="nb">gets</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">line</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">to_i</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">line</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="n">to_i</span>

    <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">2</span>

    <span class="n">cap</span> <span class="o">=</span> <span class="no">Math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">notprime</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">numprimes</span>
        <span class="nb">p</span> <span class="o">=</span> <span class="n">primes</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">p</span> <span class="o">&gt;=</span> <span class="n">cap</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">end</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">p</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="nb">p</span><span class="o">*</span><span class="mi">2</span>
        <span class="k">else</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="p">((</span><span class="nb">p</span> <span class="o">-</span> <span class="n">m</span> <span class="o">%</span> <span class="nb">p</span><span class="p">)</span><span class="o">%</span><span class="nb">p</span><span class="p">)</span>
        <span class="k">end</span>

        <span class="n">j</span> <span class="o">=</span> <span class="n">start</span>
        <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span>
            <span class="n">notprime</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="kp">true</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="nb">p</span>
        <span class="k">end</span>
    <span class="k">end</span>

    <span class="n">i</span> <span class="o">=</span> <span class="n">m</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">notprime</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">==</span> <span class="kp">nil</span><span class="p">)</span>
            <span class="nb">print</span> <span class="n">i</span><span class="p">,</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
        <span class="k">end</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">end</span>
    <span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="k">end</span>
</pre>
</div>


<p><strong>Java</strong></p>

<div class="highlight">
<pre><span class="c1">// PRIME1 - Java</span>
<span class="c1">// AC Time: 2.20</span>

<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.Math.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Scanner</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>

        <span class="kt">int</span><span class="o">[]</span> <span class="n">primes</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="mi">4000</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">numprimes</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

        <span class="n">primes</span><span class="o">[</span><span class="n">numprimes</span><span class="o">++]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">32000</span><span class="o">;</span> <span class="n">i</span><span class="o">+=</span><span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">boolean</span> <span class="n">isprime</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="kt">double</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">;</span>

            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">numprimes</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">j</span> <span class="o">&gt;=</span> <span class="n">cap</span><span class="o">)</span> <span class="k">break</span><span class="o">;</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">primes</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">isprime</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">isprime</span><span class="o">)</span> <span class="n">primes</span><span class="o">[</span><span class="n">numprimes</span><span class="o">++]</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
        <span class="o">}</span>


        <span class="kt">int</span> <span class="n">T</span><span class="o">,</span><span class="n">N</span><span class="o">,</span><span class="n">M</span><span class="o">;</span>

        <span class="n">T</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span><span class="o">;</span> <span class="n">t</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>

            <span class="n">M</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">M</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">)</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>

            <span class="kt">boolean</span><span class="o">[]</span> <span class="n">isprime</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">boolean</span><span class="o">[</span><span class="mi">100001</span><span class="o">];</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">100001</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">isprime</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">numprimes</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">primes</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
                <span class="kt">int</span> <span class="n">start</span><span class="o">;</span>

                <span class="k">if</span> <span class="o">(</span><span class="n">p</span> <span class="o">&gt;=</span> <span class="n">M</span><span class="o">)</span> <span class="n">start</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="mi">2</span><span class="o">;</span>
                <span class="k">else</span> <span class="n">start</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="o">((</span><span class="n">p</span> <span class="o">-</span> <span class="n">M</span> <span class="o">%</span> <span class="n">p</span><span class="o">)%</span><span class="n">p</span><span class="o">);</span>

                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">start</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="o">;</span> <span class="n">j</span> <span class="o">+=</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">isprime</span><span class="o">[</span><span class="n">j</span> <span class="o">-</span> <span class="n">M</span><span class="o">]</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>

            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">M</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">isprime</span><span class="o">[</span><span class="n">i</span><span class="o">-</span><span class="n">M</span><span class="o">])</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
</div>


<p><strong>Perl</strong></p>

<div class="highlight">
<pre><span class="c1"># PRIME1 - Perl</span>
<span class="c1"># AC Time: 4.28s</span>
<span class="nv">@primes</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;=</span> <span class="mi">32000</span><span class="p">;</span> <span class="nv">$i</span><span class="o">+=</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$isprime</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nv">$cap</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nv">$i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">foreach</span> <span class="nv">$p</span> <span class="p">(</span><span class="nv">@primes</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$p</span> <span class="o">&gt;=</span> <span class="nv">$cap</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">last</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="nv">%</span> <span class="err">$</span><span class="nv">p</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$isprime</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">last</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$isprime</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">push</span><span class="p">(</span><span class="nv">@primes</span><span class="p">,</span><span class="nv">$i</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="nv">$T</span> <span class="o">=</span> <span class="sr">&lt;STDIN&gt;</span><span class="p">;</span>

<span class="k">for</span> <span class="p">(</span><span class="nv">$t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$t</span> <span class="o">&lt;</span> <span class="nv">$T</span><span class="p">;</span> <span class="nv">$t</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">print</span> <span class="s">""</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$in</span> <span class="o">=</span> <span class="sr">&lt;STDIN&gt;</span><span class="p">;</span>
    <span class="nv">@line</span> <span class="o">=</span> <span class="nb">split</span><span class="p">(</span><span class="sr">/ /</span><span class="p">,</span><span class="nv">$in</span><span class="p">);</span>
    <span class="nv">$M</span> <span class="o">=</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="nv">$N</span> <span class="o">=</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$M</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$M</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$cap</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nv">$N</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

    <span class="nv">@isprime</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">)</span> <span class="n">x</span> <span class="mi">100001</span><span class="p">);</span>

    <span class="k">foreach</span> <span class="nv">$p</span> <span class="p">(</span><span class="nv">@primes</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$p</span> <span class="o">&gt;=</span> <span class="nv">$cap</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">last</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$p</span> <span class="o">&gt;=</span> <span class="nv">$M</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$start</span> <span class="o">=</span> <span class="nv">$p</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nv">$start</span> <span class="o">=</span> <span class="nv">$M</span> <span class="o">+</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">-</span> <span class="nv">$M</span> <span class="nv">%</span> <span class="err">$</span><span class="nv">p</span><span class="p">)</span> <span class="nv">%</span> <span class="err">$</span><span class="nv">p</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="nv">$j</span> <span class="o">=</span> <span class="nv">$start</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">&lt;=</span> <span class="nv">$N</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">+=</span> <span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$isprime</span><span class="p">[</span><span class="nv">$j</span><span class="o">-</span><span class="nv">$M</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="nv">$M</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;=</span> <span class="nv">$N</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$isprime</span><span class="p">[</span><span class="nv">$i</span><span class="o">-</span><span class="nv">$M</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">print</span> <span class="s">"$i\n"</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
</div>


<p><strong>C#</strong></p>

<div class="highlight">
<pre><span class="c1">// PRIME1 - C# (gmcs)</span>
<span class="c1">// AC Time: 1.50s</span>

<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">class</span> <span class="nc">PRIME1</span> <span class="p">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span> <span class="p">{</span>

        <span class="kt">int</span><span class="p">[]</span> <span class="n">primes</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">int</span><span class="p">[</span><span class="m">4000</span><span class="p">];</span>
        <span class="kt">int</span> <span class="n">numprimes</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="n">primes</span><span class="p">[</span><span class="n">numprimes</span><span class="p">++]</span> <span class="p">=</span> <span class="m">2</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">3</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;=</span> <span class="m">32000</span><span class="p">;</span> <span class="n">i</span><span class="p">+=</span><span class="m">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">bool</span> <span class="n">isprime</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="kt">double</span> <span class="n">cap</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">Sqrt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">+</span> <span class="m">1.0</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="n">numprimes</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="p">&gt;=</span> <span class="n">cap</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">%</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">isprime</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">isprime</span><span class="p">)</span> <span class="n">primes</span><span class="p">[</span><span class="n">numprimes</span><span class="p">++]</span> <span class="p">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kt">int</span> <span class="n">T</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="p">;</span>
        <span class="n">T</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">Console</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">());</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">t</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">t</span> <span class="p">&lt;</span> <span class="n">T</span><span class="p">;</span> <span class="n">t</span><span class="p">++)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">""</span><span class="p">);</span>

            <span class="kt">string</span><span class="p">[]</span> <span class="n">parts</span> <span class="p">=</span> <span class="n">Console</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">().</span><span class="n">Split</span><span class="p">(</span><span class="sc">' '</span><span class="p">);</span>
            <span class="n">M</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>
            <span class="n">N</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="m">1</span><span class="p">]);</span>


            <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="p">&lt;</span> <span class="m">2</span><span class="p">)</span> <span class="n">M</span> <span class="p">=</span> <span class="m">2</span><span class="p">;</span>
            <span class="kt">double</span> <span class="n">cap</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">Sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)+</span><span class="m">1</span><span class="p">;</span>

            <span class="kt">bool</span><span class="p">[]</span> <span class="n">isprime</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">bool</span><span class="p">[</span><span class="m">100001</span><span class="p">];</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">100001</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> <span class="n">isprime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">numprimes</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> <span class="p">{</span>
                <span class="kt">int</span> <span class="n">p</span> <span class="p">=</span> <span class="n">primes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="p">&gt;=</span> <span class="n">cap</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
                <span class="kt">int</span> <span class="n">start</span><span class="p">;</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="p">&gt;=</span> <span class="n">M</span><span class="p">)</span> <span class="n">start</span> <span class="p">=</span> <span class="n">p</span><span class="p">*</span><span class="m">2</span><span class="p">;</span>
                <span class="k">else</span> <span class="n">start</span> <span class="p">=</span> <span class="n">M</span> <span class="p">+</span> <span class="p">((</span><span class="n">p</span> <span class="p">-</span> <span class="n">M</span> <span class="p">%</span> <span class="n">p</span><span class="p">)%</span><span class="n">p</span><span class="p">);</span>

                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="n">start</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="n">j</span><span class="p">+=</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">isprime</span><span class="p">[</span><span class="n">j</span> <span class="p">-</span> <span class="n">M</span><span class="p">]</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="n">M</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">isprime</span><span class="p">[</span><span class="n">i</span><span class="p">-</span><span class="n">M</span><span class="p">]</span> <span class="p">==</span> <span class="k">true</span><span class="p">)</span> <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
</div>


<p><strong>GNU Pascal</strong></p>

<div class="highlight">
<pre><span class="cm">{</span>
<span class="cm">    PRIME1 - GNU Pascal</span>
<span class="cm">    AC Time: 0.54</span>
<span class="cm">}</span>

<span class="k">program</span> <span class="n">PRIME1</span><span class="o">;</span>
<span class="k">var</span>
    <span class="n">primes</span><span class="o">:</span> <span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">4000</span><span class="p">]</span> <span class="k">of</span> <span class="kt">integer</span><span class="o">;</span>
    <span class="n">numprimes</span><span class="o">:</span> <span class="kt">integer</span><span class="o">;</span>
    <span class="n">i</span><span class="o">,</span><span class="n">j</span><span class="o">:</span> <span class="kt">integer</span><span class="o">;</span>
    <span class="n">cap</span><span class="o">:</span> <span class="kt">double</span><span class="o">;</span>
    <span class="n">isprime</span><span class="o">:</span> <span class="kt">boolean</span><span class="o">;</span>
    <span class="n">T</span><span class="o">,</span><span class="n">N</span><span class="o">,</span><span class="n">M</span><span class="o">:</span> <span class="kt">integer</span><span class="o">;</span>
    <span class="n">isp</span><span class="o">:</span> <span class="k">array</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">100001</span><span class="p">]</span> <span class="k">of</span> <span class="kt">boolean</span><span class="o">;</span>
    <span class="n">p</span><span class="o">,</span><span class="n">start</span><span class="o">:</span> <span class="kt">integer</span><span class="o">;</span>


<span class="k">begin</span>
    <span class="n">primes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">:=</span> <span class="mi">2</span><span class="o">;</span>
    <span class="n">numprimes</span> <span class="o">:=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="mi">3</span> <span class="k">to</span> <span class="mi">32000</span> <span class="k">do</span>
    <span class="k">begin</span>
        <span class="n">isprime</span> <span class="o">:=</span> <span class="k">true</span><span class="o">;</span>
        <span class="n">cap</span> <span class="o">:=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
        <span class="k">for</span> <span class="n">j</span> <span class="o">:=</span> <span class="mi">1</span> <span class="k">to</span> <span class="n">numprimes</span> <span class="k">do</span>
        <span class="k">begin</span>
            <span class="k">if</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">cap</span> <span class="k">then</span>
                    <span class="k">break</span><span class="o">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="k">MOD</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
            <span class="k">begin</span>
                <span class="n">isprime</span> <span class="o">:=</span> <span class="k">false</span><span class="o">;</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">end</span>
        <span class="k">end</span><span class="o">;</span>

        <span class="k">if</span> <span class="n">isprime</span> <span class="o">=</span> <span class="k">true</span> <span class="k">then</span>
        <span class="k">begin</span>
            <span class="n">numprimes</span> <span class="o">:=</span> <span class="n">numprimes</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
            <span class="n">primes</span><span class="p">[</span><span class="n">numprimes</span><span class="p">]</span> <span class="o">:=</span> <span class="n">i</span>
        <span class="k">end</span>
    <span class="k">end</span><span class="o">;</span>

    <span class="nb">read</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">;</span>

    <span class="k">for</span> <span class="n">t</span> <span class="o">:=</span> <span class="mi">1</span> <span class="k">to</span> <span class="n">T</span> <span class="k">do</span>
    <span class="k">begin</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">then</span>
            <span class="nb">writeln</span><span class="p">(</span><span class="s">''</span><span class="p">)</span><span class="o">;</span>

        <span class="nb">read</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">;</span>
        <span class="nb">read</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">;</span>

        <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">then</span>
            <span class="n">M</span> <span class="o">:=</span> <span class="mi">2</span><span class="o">;</span>

        <span class="n">cap</span> <span class="o">:=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>

        <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">100001</span> <span class="k">do</span>
            <span class="n">isp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">:=</span> <span class="k">true</span><span class="o">;</span>


        <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="mi">1</span> <span class="k">to</span> <span class="n">numprimes</span> <span class="k">do</span>
        <span class="k">begin</span>
            <span class="n">p</span> <span class="o">:=</span> <span class="n">primes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">;</span>
            <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;=</span> <span class="n">cap</span> <span class="k">then</span>
                <span class="k">break</span><span class="o">;</span>

            <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;=</span> <span class="n">M</span> <span class="k">then</span>
                <span class="n">start</span> <span class="o">:=</span> <span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span><span class="o">;</span>

            <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">M</span> <span class="k">then</span>
                <span class="n">start</span> <span class="o">:=</span> <span class="n">M</span> <span class="o">+</span> <span class="p">((</span><span class="n">p</span> <span class="o">-</span> <span class="p">(</span><span class="n">M</span> <span class="k">MOD</span> <span class="n">p</span><span class="p">))</span> <span class="k">MOD</span> <span class="n">p</span><span class="p">)</span><span class="o">;</span>

            <span class="n">j</span> <span class="o">:=</span> <span class="n">start</span><span class="o">;</span>

            <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">N</span> <span class="k">do</span>
            <span class="k">begin</span>
                <span class="n">isp</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="n">M</span><span class="p">]</span> <span class="o">:=</span> <span class="k">false</span><span class="o">;</span>
                <span class="n">j</span> <span class="o">:=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">p</span><span class="o">;</span>
            <span class="k">end</span><span class="o">;</span>
        <span class="k">end</span><span class="o">;</span>

        <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="n">M</span> <span class="k">to</span> <span class="n">N</span> <span class="k">do</span>
        <span class="k">begin</span>
            <span class="k">if</span> <span class="n">isp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span> <span class="k">then</span>
                <span class="nb">writeln</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">;</span>
        <span class="k">end</span><span class="o">;</span>
    <span class="k">end</span><span class="o">;</span>
<span class="k">end</span><span class="o">.</span>
</pre>
</div>
</body></html>

</div>

<div class="related post-list">
  <h2>Related Posts</h2>
  <ul class="post-list-ul">
    
      <li>
        <a href="/2011/10/03/meet-doctor-jekyll/">Meet Doctor Jekyll</a>
        <span class='date'>03 October 2011</span>
      </li>
    
      <li>
        <a href="/2011/06/25/complex-asynchronous-queries-in-javascript/">Complex Asynchronous Queries in JavaScript</a>
        <span class='date'>25 June 2011</span>
      </li>
    
      <li>
        <a href="/2011/01/12/hacker-cup-qualification-round-solutions/">Hacker Cup Qualification Round - Solutions</a>
        <span class='date'>12 January 2011</span>
      </li>
    
      <li>
        <a href="/2010/11/17/mechanize-and-uwace-downloader/">Mechanize and UWAce Downloader</a>
        <span class='date'>17 November 2010</span>
      </li>
    
      <li>
        <a href="/2010/10/16/dfas-and-graphviz-dot/">DFAs and Graphviz DOT</a>
        <span class='date'>16 October 2010</span>
      </li>
    
  </ul>
</div>


</div>

        </div>
      </div>
    </div>

    
    <!-- google analytics async -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(["_setAccount", "UA-11869199-1"]);
      _gaq.push(["_trackPageview"]);
      (function() {
        var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;
        ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";
        var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    
  </body>
</html>
