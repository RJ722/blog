<!DOCTYPE html>
<html>
  <head>
    <title>Google Codejam 2010 Solutions - Qualification - Zero Wind :: Jamie Wong</title>
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

    <link href='http://fonts.googleapis.com/css?family=Questrial|Sansita+One' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" media="screen" href="/stylesheets/screen.css" type="text/css" />
    <link rel="stylesheet" media="screen" href="/stylesheets/pygments.css" type="text/css" />
  </head>

  <body class="bp" onload="prettyPrint()">
    <div class="page-container">
      <div class="page-sidebar-container">
        <div class="page-sidebar">

          <a href="/"><h1 class="site-title">
            Zer√∏ Wind
          </h1></a>

          <h2 class='my-name'>Jamie Wong</h2>

          <div class='short-bio'>
            <p>
              I'm a uWaterloo Software Engineering student from Ottawa.
              I'm currently an intern at Facebook.
            </p>
          </div>

          <div class="page-nav">
            <ul>
              <li><a href="/">blog</a></li>
              <li><a href="/resume/">resume</a></li>
              <li><a href="https://github.com/phleet">github</a></li>
              <li><a href="http://twitter.com/jlfwong">twitter</a></li>
              <li><a href="http://www.linkedin.com/profile/view?id=71283243">linkedin</a></li>
              <li><a href="http://stackoverflow.com/users/303911/jamie-wong">stack overflow</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div class="page-content-container">
        <div class="page-content">
          
            <h1 class='page-title'>Google Codejam 2010 Solutions - Qualification</h1>
          

          
<div class="post-date">
  Posted on May 11, 2010
</div>


<div class="post">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<p>I'm happy to have qualified for Codejam for the second year running - I managed to make it to Online Round 2 last year, so let's see if I can top that this year.</p>

<p>The opening round was not very difficult, and were it not for a very stupid mistake on my part on the first question, I easily could have gotten perfect in under 2.5 hours. Instead I got 76 in 3.5 hours. Bah.</p>

<p>Read the questions here: <a href="http://code.google.com/codejam/contest/dashboard?c=433101#">Qualification Round 2010 @ code.google.com</a></p>

<h1>Problem 1: Snapper Chain</h1>


<p>This is the one I screwed up, because I somehow overlooked the fact that each snap was simply equivalent to an binary increment of the snappers states. Instead, I did a foolish simulation, which did actually pass me the small test case. But anyway, the real solution is O(1).</p>

<p>For interest, here's what the snapper chain looks like in the first 30 iterations. The left side, labeled "P:" shows which of the snappers are powered, and the right side, labeled "S:" shows the current state of the snappers, with "#" being ON and "." being OFF in both cases. I did this so it would be easier to see the pattern. The first row is the initial set up, before any snaps.</p>

<pre><code>P: #.........   S: ..........
P: ##........   S: #.........
P: #.........   S: .#........
P: ###.......   S: ##........
P: #.........   S: ..#.......
P: ##........   S: #.#.......
P: #.........   S: .##.......
P: ####......   S: ###.......
P: #.........   S: ...#......
P: ##........   S: #..#......
P: #.........   S: .#.#......
P: ###.......   S: ##.#......
P: #.........   S: ..##......
P: ##........   S: #.##......
P: #.........   S: .###......
P: #####.....   S: ####......
P: #.........   S: ....#.....
P: ##........   S: #...#.....
P: #.........   S: .#..#.....
P: ###.......   S: ##..#.....
P: #.........   S: ..#.#.....
P: ##........   S: #.#.#.....
P: #.........   S: .##.#.....
P: ####......   S: ###.#.....
P: #.........   S: ...##.....
P: ##........   S: #..##.....
P: #.........   S: .#.##.....
P: ###.......   S: ##.##.....
P: #.........   S: ..###.....
P: ##........   S: #.###.....
</code></pre>

<p>What we're interested in is how to tell where a specific snapper is on. It turns
out that this is quite simple - so long as all snappers before it are on the ON
settings, it will be powered. This means that ultimately, the power column above
is irrelevant. All we need to know is that the N-1 least significant bits are
set. This is fairly trivial to check.</p>

<div class="highlight">
<pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">T</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">K</span><span class="p">;</span>
  <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span><span class="p">;</span> <span class="n">t</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">N</span> <span class="o">&gt;&gt;</span> <span class="n">K</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Case #%d: "</span><span class="p">,</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">K</span><span class="p">)</span> <span class="o">==</span> <span class="n">mask</span><span class="p">)</span> <span class="n">puts</span><span class="p">(</span><span class="s">"ON"</span><span class="p">);</span>
    <span class="k">else</span> <span class="n">puts</span><span class="p">(</span><span class="s">"OFF"</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>
</div>


<p>Time for the large case:</p>

<div class="highlight">
<pre><span class="nv">$ </span><span class="nb">time</span> ./a.out &lt; snapper.in &gt; snapper.out

real    0m0.071s
user    0m0.026s
sys     0m0.040s
</pre>
</div>


<h1>Problem 2: Fair Warning</h1>


<p>This problem took me about 40 minutes to think of the solution for and about 5
minutes to code. Honour's Algebra (MATH 115) came in handy here. You can first
calculate T (the optimal anniversary) by looking at the gcd (greatest common
divisor) of the differences between the time elapsed since the events. This
works because in order for T to divide the time elapsed since the events, it
must also divide the time elapsed between the events. After that, you just need
to find the first y that makes any of the numbers divisible by T. I just wrote
out the congruences on my whiteboard (which I probably shouldn't have needed to
do) then typed in my answer.</p>

<p>The only remaining problem here is dealing with the large numbers, which is
hardly a problem in python. Here's my solution:</p>

<div class="highlight">
<pre><span class="k">def</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">while</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">%</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">y</span>

<span class="n">testcases</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"warning.in"</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">tc</span> <span class="ow">in</span> <span class="n">testcases</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
  <span class="n">tc</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">tc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">" "</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tc</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">break</span>
  <span class="n">tc</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
  <span class="c">#print tc</span>

  <span class="n">diff</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tc</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">diff</span> <span class="o">+=</span> <span class="p">[</span><span class="n">tc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tc</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>

  <span class="n">T</span> <span class="o">=</span> <span class="n">diff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diff</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">d</span><span class="p">)</span>

  <span class="c">#print T</span>
  <span class="k">print</span> <span class="s">"Case #</span><span class="si">%d</span><span class="s">: </span><span class="si">%d</span><span class="s">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">tc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">%</span> <span class="n">T</span><span class="p">))</span>

  <span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>
</pre>
</div>


<p>Time for large case:</p>

<div class="highlight">
<pre><span class="nv">$ </span><span class="nb">time </span>python warning.py &gt; warning.out

real    0m0.250s
user    0m0.037s
sys     0m0.021s
</pre>
</div>


<h1>Problem 3: Theme Park</h1>


<p>This is an optimization problem. There are a lot of different optimizations you
can apply, but I figured "to hell with it" and decided the solution getting it
down to O(R) was probably sufficient. If you want to look at a better list of
optimizations, go look here: <a href="http://code.google.com/codejam/contest/dashboard?c=433101#s=a&amp;a=2">Google
Codejam 2010 Qualification Round Contest Analysis</a>.</p>

<p>All I figured I needed to do was make it so I didn't have to find the groups
every single time the ride was loaded. To do this, I simulated using a queue
until I arrived at a position where the group at the front of the line had been
at the front before. While doing this, I record how many euros were made for a
given start of the line, and who ends up at the front of the line while they're
on the roller coaster. After this, the O(R) loop is very simple. Just add the
number of euros for the run, then move on to the next front of the line.</p>

<div class="highlight">
<pre><span class="cp">#include &lt;cmath&gt;</span>
<span class="cp">#include &lt;algorithm&gt;</span>
<span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &lt;cstdio&gt;</span>
<span class="cp">#include &lt;cstdlib&gt;</span>
<span class="cp">#include &lt;cstring&gt;</span>
<span class="cp">#include &lt;queue&gt;</span>
<span class="cp">#include &lt;set&gt;</span>
<span class="cp">#include &lt;map&gt;</span>
<span class="cp">#include &lt;sstream&gt;</span>
<span class="cp">#include &lt;vector&gt;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="cp">#define FR(i,a,b) for(int i=(a);i&lt;(b);++i)</span>
<span class="cp">#define FOR(i,n) FR(i,0,n)</span>
<span class="cp">#define SETMIN(a,b) a = min(a,b)</span>
<span class="cp">#define SETMAX(a,b) a = max(a,b)</span>
<span class="cp">#define PB push_back</span>
<span class="cp">#define FORALL(i,v) for(typeof((v).end())i=(v).begin();i!=(v).end();++i)</span>
<span class="cp">#define CLR(x,a) memset(x,a,sizeof(x))</span>
<span class="cp">#define BEND(v) v.begin(),v.end()</span>
<span class="cp">#define MP make_pair</span>
<span class="cp">#define A first</span>
<span class="cp">#define B second</span>

<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="kt">int</span> <span class="n">ull</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">double</span> <span class="n">ld</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">freopen</span><span class="p">(</span><span class="s">"themepark.in"</span><span class="p">,</span><span class="s">"r"</span><span class="p">,</span><span class="n">stdin</span><span class="p">);</span>
    <span class="n">freopen</span><span class="p">(</span><span class="s">"themepark.out"</span><span class="p">,</span><span class="s">"w"</span><span class="p">,</span><span class="n">stdout</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">T</span><span class="p">;</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
    <span class="n">FOR</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">T</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">N</span><span class="p">;</span>
        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">R</span> <span class="o">&gt;&gt;</span> <span class="n">k</span> <span class="o">&gt;&gt;</span> <span class="n">N</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">grps</span><span class="p">[</span><span class="mi">1001</span><span class="p">],</span> <span class="n">done</span><span class="p">[</span><span class="mi">1001</span><span class="p">],</span> <span class="n">pts</span><span class="p">[</span><span class="mi">1001</span><span class="p">],</span> <span class="n">next</span><span class="p">[</span><span class="mi">1001</span><span class="p">];</span>
        <span class="n">CLR</span><span class="p">(</span><span class="n">done</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">queue</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
        <span class="n">FOR</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">grps</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">MP</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">grps</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
        <span class="p">}</span>

        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">done</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">().</span><span class="n">A</span><span class="p">])</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">cur</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">start</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">().</span><span class="n">A</span><span class="p">;</span>
            <span class="n">done</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

            <span class="n">FOR</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">cur</span> <span class="o">+</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">().</span><span class="n">B</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>

                <span class="n">cur</span> <span class="o">+=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">().</span><span class="n">B</span><span class="p">;</span>
                <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">());</span>
                <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="n">next</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">().</span><span class="n">A</span><span class="p">;</span>
            <span class="n">pts</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="n">cur</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>

        <span class="kt">int</span> <span class="n">curFront</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">ull</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">FOR</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ans</span> <span class="o">+=</span> <span class="n">pts</span><span class="p">[</span><span class="n">curFront</span><span class="p">];</span>
            <span class="n">curFront</span> <span class="o">=</span> <span class="n">next</span><span class="p">[</span><span class="n">curFront</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="n">printf</span><span class="p">(</span><span class="s">"Case #%d: %lld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ans</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>
</div>


<p>Time for large test case:</p>

<div class="highlight">
<pre><span class="nv">$ </span><span class="nb">time</span> ./a.out

real    0m11.606s
user    0m11.542s
sys     0m0.022s
</pre>
</div>


<p>I might code up an O(N) solution later, which really isn't that difficult, but
at this point in the contest, it simply didn't matter enough.</p>
</body></html>

</div>

<div class="related post-list">
  <h2>Related Posts</h2>
  <ul class="post-list-ul">
    
      <li>
        <a href="/2011/11/03/meet-doctor-jekyll/">Meet Doctor Jekyll</a>
        <span class='date'>03 November 2011</span>
      </li>
    
      <li>
        <a href="/2011/06/25/complex-asynchronous-queries-in-javascript/">Complex Asynchronous Queries in JavaScript</a>
        <span class='date'>25 June 2011</span>
      </li>
    
      <li>
        <a href="/2011/01/12/hacker-cup-qualification-round-solutions/">Hacker Cup Qualification Round - Solutions</a>
        <span class='date'>12 January 2011</span>
      </li>
    
      <li>
        <a href="/2010/11/17/mechanize-and-uwace-downloader/">Mechanize and UWAce Downloader</a>
        <span class='date'>17 November 2010</span>
      </li>
    
      <li>
        <a href="/2010/10/16/dfas-and-graphviz-dot/">DFAs and Graphviz DOT</a>
        <span class='date'>16 October 2010</span>
      </li>
    
  </ul>
</div>


</div>

        </div>
      </div>
    </div>

    
    <!-- google analytics async -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(["_setAccount", "UA-11869199-1"]);
      _gaq.push(["_trackPageview"]);
      (function() {
        var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;
        ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";
        var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    
  </body>
</html>
