<!DOCTYPE html>
<html>
  <head>
    <title>Mechanize and UWAce Downloader - Zero Wind :: Jamie Wong</title>
    <meta property="og:image" content="http://jamie-wong.com/images/logo.png" />
    <meta property="og:site_name" content="Zero Wind :: Jamie Wong" />

    <link rel="icon" href="/favicon.ico" />

    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

    <link href='http://fonts.googleapis.com/css?family=Questrial|Sansita+One' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" media="screen" href="/stylesheets/screen.css" type="text/css" />
    <link rel="stylesheet" media="screen" href="/stylesheets/pygments.css" type="text/css" />
  </head>

  <body class="bp">
    <div class="page-container">
      <div class="page-sidebar-container">
        <div class="page-sidebar">

          <a href="/"><h1 class="site-title">
            Zer√∏ Wind
          </h1></a>

          <h2 class='my-name'>Jamie Wong</h2>

          <div class='short-bio'>
            <p>
              I'm a uWaterloo Software Engineering student from Ottawa.
              I'm currently an intern at Facebook.
            </p>
          </div>

          <div class="page-nav">
            <ul>
              <li><a href="/">blog</a></li>
              <li><a href="/resume/">resume</a></li>
              <li><a href="https://github.com/phleet">github</a></li>
              <li><a href="http://twitter.com/jlfwong">twitter</a></li>
              <li><a href="http://www.linkedin.com/profile/view?id=71283243">linkedin</a></li>
              <li><a href="http://stackoverflow.com/users/303911/jamie-wong">stack overflow</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div class="page-content-container">
        <div class="page-content">
          
            <h1 class='page-title'>Mechanize and UWAce Downloader</h1>
          

          
<div class="post-date">
  Posted on November 17, 2010
</div>


<div class="post">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<p>A while ago I made something in php that would let you download things form UW-Ace (the University of Waterloo's course management system) from the command-line. Michael Chang had the excellent idea of making something that would simply download everything available to you from Ace so you could have a local copy of everything.</p>

<p>His solution was an extension of my php solution.</p>

<p>Because I wanted to make the product easier to distribute and because I wanted to make use of Mechanize, I rewrote the solution in ruby and packaged it as a gem.</p>

<h1>UWAce Downloader</h1>

<p>The new version looks like this:</p>

<p><img src="http://phleet.github.com/images/uwacegem.png" alt="uwace gem screenshot"></p>

<p>To get it running, you'll need a copy of RubyGems, which you can get here: <a href="http://rubygems.org/pages/download">Download RubyGems</a>. It's a simple package management and distribution system for ruby, which is used by more or less every ruby project you can think of.</p>

<p>Once you have that set up, just run</p>

<pre><code>sudo gem install uwace
</code></pre>

<p>Wait for it to finish installing, then run</p>

<pre><code>uwace
</code></pre>

<p>Which will prompt you for a username and password.
Of course, I wouldn't release anything that asks for your password without releasing source, so here it is:</p>

<ul>
<li><a href="https://github.com/phleet/UWAngel-CLI">uwace gem @ github</a></li>
<li><a href="https://rubygems.org/gems/uwace">uwace gem @ RubyGems</a></li>
</ul>
<h1>Mechanize</h1>

<p>This version of the downloader is written in ruby with the aid of Mechanize for ruby.
Mechanize is a set of tools for automating webpage interactions and retrieving data. It can identify links and forms on a page, fill them in, submit them and grab any data you want. Perfect for this task.</p>

<p>There's a simple guide on github here: <a href="https://github.com/tenderlove/mechanize/blob/master/GUIDE.rdoc">Getting Started with Mechanize</a></p>

<p>To demonstrate how simple form interaction is, here's the method for login:</p>

<div class="highlight">
<pre><span class="k">def</span> <span class="nf">login</span>
  <span class="vi">@username</span> <span class="o">||=</span> <span class="n">ask</span><span class="p">(</span><span class="s2">"Username: "</span><span class="p">)</span>
  <span class="vi">@password</span> <span class="o">||=</span> <span class="n">ask</span><span class="p">(</span><span class="s2">"Password: "</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">q</span><span class="o">|</span> <span class="n">q</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="s1">'*'</span><span class="p">}</span>

  <span class="n">say</span> <span class="s2">"Logging in ..."</span>

  <span class="n">login_page</span> <span class="o">=</span> <span class="n">angel_get</span> <span class="s1">'home.asp'</span>
  <span class="n">form</span> <span class="o">=</span> <span class="n">login_page</span><span class="o">.</span><span class="n">form_with</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"frmLogon"</span><span class="p">)</span>
  <span class="n">form</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="vi">@username</span>
  <span class="n">form</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="vi">@password</span>

  <span class="n">login_submit_page</span> <span class="o">=</span> <span class="vi">@agent</span><span class="o">.</span><span class="n">submit</span> <span class="n">form</span>

  <span class="k">if</span> <span class="n">login_submit_page</span><span class="o">.</span><span class="n">uri</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">include?</span> <span class="s1">'authenticate.asp'</span>
    <span class="k">raise</span> <span class="no">InvalidLogin</span>
  <span class="k">end</span>
<span class="k">rescue</span> <span class="no">InvalidLogin</span>
  <span class="n">say</span> <span class="s1">'Invalid Username/Password'</span>
  <span class="nb">exit</span>
<span class="k">end</span>
</pre>
</div>


<p>While I've only used the Mechanize bindings for ruby, there bindings for many other languages:</p>

<ul>
<li><a href="http://wwwsearch.sourceforge.net/mechanize/">Python's Mechanize</a></li>
<li>
<a href="http://search.cpan.org/dist/WWW-Mechanize/lib/WWW/Mechanize/Cookbook.pod">Perl's WWW::Mechanize</a> - This was actually the original Mechanize</li>
</ul>
</body></html>

</div>

<div class="related post-list">
  <h2>Related Posts</h2>
  <ul class="post-list-ul">
    
      <li>
        <a href="/2011/10/03/meet-doctor-jekyll/">Meet Doctor Jekyll</a>
        <span class='date'>03 October 2011</span>
      </li>
    
      <li>
        <a href="/2011/06/25/complex-asynchronous-queries-in-javascript/">Complex Asynchronous Queries in JavaScript</a>
        <span class='date'>25 June 2011</span>
      </li>
    
      <li>
        <a href="/2011/01/12/hacker-cup-qualification-round-solutions/">Hacker Cup Qualification Round - Solutions</a>
        <span class='date'>12 January 2011</span>
      </li>
    
      <li>
        <a href="/2010/10/16/dfas-and-graphviz-dot/">DFAs and Graphviz DOT</a>
        <span class='date'>16 October 2010</span>
      </li>
    
      <li>
        <a href="/2010/09/30/make-your-life-easier-with-gnu-make/">Make your life easier with GNU Make.</a>
        <span class='date'>30 September 2010</span>
      </li>
    
  </ul>
</div>


</div>

        </div>
      </div>
    </div>

    
    <!-- google analytics async -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(["_setAccount", "UA-11869199-1"]);
      _gaq.push(["_trackPageview"]);
      (function() {
        var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;
        ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";
        var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    
  </body>
</html>
